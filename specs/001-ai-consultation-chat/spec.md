# Feature Specification: AI 전문가 상담 채팅 서비스

**Feature Branch**: `001-ai-consultation-chat`
**Created**: 2026-02-27
**Status**: Draft
**Input**: AI 전문가 상담 채팅 서비스 - 4개 분야(취업, 연애, 사주, 육아) AI 전문가와 1:1 채팅 상담 웹앱

## User Scenarios & Testing *(mandatory)*

### User Story 1 - 구글 로그인으로 서비스 시작 (Priority: P1)

비로그인 사용자가 온보딩 랜딩 페이지에서 서비스 소개를 확인하고, "지금 시작하기" 버튼을 눌러 구글 계정으로 로그인한 뒤 메인 화면에 진입한다. 재방문 시에는 자동 로그인되어 바로 메인 화면으로 이동한다.

**Why this priority**: 인증은 모든 기능의 전제 조건이며, 사용자가 서비스에 접근하는 첫 관문이다. 이 기능 없이는 어떤 상담도 이용할 수 없다.

**Independent Test**: 구글 계정으로 로그인하여 메인 화면에 도달하는 것만으로 독립적으로 테스트 가능하며, "서비스에 접속할 수 있다"는 핵심 가치를 전달한다.

**Acceptance Scenarios**:

1. **Given** 비로그인 상태로 웹에 접속한 사용자, **When** 온보딩 페이지가 로드되면, **Then** CTA 섹션, 서비스 소개 섹션, 상담 분야 소개 섹션이 순서대로 표시되고 하단에 면책 문구가 보인다.
2. **Given** 온보딩 페이지를 보는 사용자, **When** "지금 시작하기" 버튼을 클릭하면, **Then** 구글 로그인 화면으로 이동한다.
3. **Given** 구글 로그인을 완료한 사용자, **When** 인증이 성공하면, **Then** 메인 화면(헤더 + 사이드바 + 콘텐츠 영역)이 표시되고, 사이드바의 "시작하기" 메뉴가 기본 선택 상태이다.
4. **Given** 이전에 로그인한 적 있는 사용자, **When** 재방문하면, **Then** 온보딩 페이지를 거치지 않고 자동으로 메인 화면에 진입한다.
5. **Given** 로그인된 사용자, **When** 헤더의 프로필 아이콘을 확인하면, **Then** 자신의 구글 프로필 이미지가 표시된다.

---

### User Story 2 - 전문가 선택 및 새 상담 시작 (Priority: P1)

로그인한 사용자가 "시작하기" 페이지에서 4개 분야(취업, 연애, 사주, 육아) 중 원하는 전문가를 선택하여 새로운 1:1 채팅 상담을 시작한다.

**Why this priority**: 상담 시작은 서비스의 핵심 가치이자 주요 사용 흐름의 시작점이다. 전문가 선택 없이는 상담이 불가능하다.

**Independent Test**: 전문가를 선택하여 채팅방이 생성되고 첫 인사말을 받는 것만으로 독립적으로 테스트 가능하며, "AI 전문가와 상담을 시작할 수 있다"는 핵심 가치를 전달한다.

**Acceptance Scenarios**:

1. **Given** 메인 화면의 "시작하기" 페이지에 있는 사용자, **When** 페이지가 로드되면, **Then** 4개 분야의 전문가 카드(아이콘, 이름, 분야 설명 포함)가 표시된다.
2. **Given** 전문가 카드 목록을 보는 사용자, **When** 특정 전문가를 선택하면, **Then** 새 채팅방이 자동 생성되고 해당 채팅방으로 이동한다.
3. **Given** 새 채팅방에 입장한 사용자, **When** 채팅방이 로드되면, **Then** 상단에 전문가 이름과 분야가 표시되고, AI 전문가의 인사말이 자동으로 나타난다.
4. **Given** 이미 특정 분야의 상담 이력이 있는 사용자, **When** 같은 분야의 전문가를 다시 선택하면, **Then** 기존 상담과 독립된 새 채팅방이 생성된다.

---

### User Story 3 - AI 전문가와 실시간 채팅 상담 (Priority: P1)

사용자가 채팅방에서 AI 전문가와 메시지를 주고받으며 실시간으로 상담을 진행한다. AI는 이전 대화 맥락을 기억하며, 단계적으로 상황을 파악하고 조언한다.

**Why this priority**: 채팅 상담은 서비스의 핵심 기능이며, 사용자가 실제로 가치를 경험하는 주요 순간이다.

**Independent Test**: 채팅방에서 메시지를 보내고 AI의 응답을 실시간으로 받는 것만으로 독립적으로 테스트 가능하며, "AI 전문가에게 상담받는다"는 핵심 가치를 전달한다.

**Acceptance Scenarios**:

1. **Given** 채팅방에 있는 사용자, **When** 텍스트 메시지를 입력하고 전송(전송 버튼 또는 Enter 키)하면, **Then** 사용자의 메시지가 오른쪽 말풍선으로 즉시 표시된다.
2. **Given** 사용자가 메시지를 전송한 직후, **When** AI가 응답을 생성 중이면, **Then** 타이핑 표시(...)가 나타나고, 응답이 실시간으로 한 글자씩 스트리밍되어 왼쪽 말풍선에 표시된다.
3. **Given** AI 전문가가 사용자의 첫 메시지를 받았을 때, **When** 응답을 생성하면, **Then** 바로 답을 주지 않고 상황 파악 질문을 먼저 던진다.
4. **Given** 충분한 정보가 모인 상태에서, **When** AI가 조언을 제공하면, **Then** 핵심 조언 → 구체적 행동 제안 → 추가 궁금점 확인 순서로 단계적으로 안내한다.
5. **Given** 채팅방 화면에서, **When** 입력창 바로 위를 확인하면, **Then** 면책 문구가 작은 글씨로 상시 표시되어 있다.
6. **Given** 위험 주제(건강 이상, 심각한 갈등 등)가 대화에서 감지되었을 때, **When** AI가 응답하면, **Then** 전문가/기관 방문 권유 안내를 포함한다.

---

### User Story 4 - 상담 이력 관리 및 이어서 상담하기 (Priority: P2)

사용자가 "나의 상담 이력" 메뉴에서 과거 상담 목록을 확인하고, 기존 채팅방을 클릭하여 이전 대화를 이어서 진행한다.

**Why this priority**: 상담의 연속성은 사용자 경험의 질을 높이는 핵심 요소이지만, 새 상담 시작이 먼저 가능해야 의미가 있다.

**Independent Test**: 상담 이력 목록에서 기존 채팅을 선택하여 이전 대화를 확인하고 이어서 상담하는 것만으로 독립적으로 테스트 가능하다.

**Acceptance Scenarios**:

1. **Given** 상담 이력이 있는 사용자, **When** "나의 상담 이력" 페이지를 열면, **Then** 채팅방 목록이 최신 순으로 표시되며, 각 항목에 전문가 이름, 채팅방 제목, 최근 활동 시간이 보인다.
2. **Given** 상담 이력 목록을 보는 사용자, **When** 특정 채팅방을 클릭하면, **Then** 해당 채팅방으로 이동하여 이전 대화 내역이 모두 표시되고 이어서 대화할 수 있다.
3. **Given** 상담 이력이 없는 사용자, **When** "나의 상담 이력" 페이지를 열면, **Then** 상담 이력이 없다는 안내와 함께 새 상담을 시작하도록 유도하는 메시지가 표시된다.

---

### User Story 5 - 상담 마무리 및 요약 생성 (Priority: P2)

사용자가 상담을 마무리하면 AI가 대화를 정리하고, 주제·핵심 조언·다음 액션 아이템이 포함된 상담 요약 카드를 생성한다. 채팅방 제목도 자동으로 생성된다.

**Why this priority**: 상담 요약은 사용자에게 실질적인 가치를 정리해 주는 기능이지만, 기본 상담 흐름이 먼저 완성되어야 한다.

**Independent Test**: 상담 종료 후 요약 카드가 생성되고 채팅방 제목이 자동 설정되는 것을 독립적으로 테스트 가능하다.

**Acceptance Scenarios**:

1. **Given** 상담 중인 사용자, **When** 종료 신호("고마워요", "이제 됐어요" 등)를 보내면, **Then** AI가 상담 내용을 정리하는 마무리 메시지를 전송한다.
2. **Given** AI가 마무리 메시지를 보낸 후, **When** 상담 요약이 생성되면, **Then** 주제, 핵심 조언, 다음 액션 아이템이 포함된 요약 카드가 채팅방 내에 표시된다.
3. **Given** 상담이 마무리된 채팅방, **When** 제목을 확인하면, **Then** AI가 대화 내용을 기반으로 자동 생성한 제목이 설정되어 있다.

---

### User Story 6 - 온보딩 랜딩 페이지 탐색 (Priority: P3)

비로그인 사용자가 온보딩 페이지에서 서비스에 대한 충분한 정보를 얻고 가입 결심을 한다.

**Why this priority**: 사용자 유입과 전환에 중요하지만, 핵심 상담 기능이 먼저 갖춰져야 한다.

**Independent Test**: 온보딩 페이지의 3개 섹션을 스크롤하며 서비스 정보를 확인하는 것만으로 독립적으로 테스트 가능하다.

**Acceptance Scenarios**:

1. **Given** 비로그인 사용자가 사이트에 접속, **When** 온보딩 페이지를 스크롤하면, **Then** CTA → 서비스 소개 → 상담 분야 소개 순서로 3개 섹션이 원페이지로 자연스럽게 이어진다.
2. **Given** 상담 분야 소개 섹션을 보는 사용자, **When** 4개 분야 카드를 확인하면, **Then** 취업, 연애, 사주, 육아 분야의 아이콘, 이름, 설명이 각각 표시된다.

---

### User Story 7 - 도움말 및 계정 정보 관리 (Priority: P3)

로그인한 사용자가 도움말 페이지에서 서비스 이용 안내를 확인하고, 계정 정보 페이지에서 자신의 정보를 조회·수정한다.

**Why this priority**: 부가 기능으로, 핵심 상담 흐름이 완성된 뒤에 구현해도 서비스 사용에 문제가 없다.

**Independent Test**: 도움말 페이지 열람 및 계정 정보 수정을 각각 독립적으로 테스트 가능하다.

**Acceptance Scenarios**:

1. **Given** 로그인된 사용자, **When** 사이드바에서 "도움말"을 선택하면, **Then** 서비스 이용 방법에 대한 안내 페이지가 표시된다.
2. **Given** 로그인된 사용자, **When** 사이드바에서 "계정 정보"를 선택하면, **Then** 자신의 프로필(닉네임, 이메일, 프로필 이미지)이 표시된다.
3. **Given** 계정 정보 페이지의 사용자, **When** 닉네임을 수정하고 저장하면, **Then** 변경된 닉네임이 즉시 반영된다.

---

### Edge Cases

- 구글 로그인 중 사용자가 인증을 취소하면 어떻게 되는가? → 온보딩 페이지로 복귀하며 오류 메시지 없이 자연스럽게 처리한다.
- AI 응답 생성 중 네트워크가 끊기면 어떻게 되는가? → 사용자에게 연결 문제를 안내하고, 재시도 옵션을 제공한다.
- 사용자가 빈 메시지를 전송하려 하면 어떻게 되는가? → 전송 버튼이 비활성화되며 빈 메시지는 전송되지 않는다.
- 매우 긴 메시지(수천 자)를 전송하면 어떻게 되는가? → 적절한 글자 수 제한을 두고, 초과 시 안내 메시지를 표시한다.
- 동시에 여러 채팅방을 열면 어떻게 되는가? → 한 번에 하나의 채팅방만 활성화되며, 다른 채팅방은 이력에서 접근 가능하다.
- AI 응답 생성이 비정상적으로 오래 걸리면 어떻게 되는가? → 일정 시간 후 타임아웃 안내와 재시도 옵션을 제공한다.

## Requirements *(mandatory)*

### Functional Requirements

- **FR-001**: 시스템은 구글 OAuth를 통한 회원가입 및 로그인을 지원해야 한다.
- **FR-002**: 시스템은 로그인 상태를 유지하여 재방문 시 자동 로그인되어야 한다.
- **FR-003**: 비로그인 사용자에게는 무조건 온보딩 랜딩 페이지를 표시해야 한다.
- **FR-004**: 온보딩 페이지는 CTA, 서비스 소개, 상담 분야 소개 3개 섹션의 원페이지 스크롤 구성이어야 한다.
- **FR-005**: 시스템은 4개 상담 분야(취업, 연애, 사주, 육아)의 전문가 목록을 제공해야 한다.
- **FR-006**: 사용자는 전문가를 선택하여 새 채팅방을 생성할 수 있어야 한다.
- **FR-007**: 같은 분야를 다시 선택해도 기존 상담과 독립된 새 채팅방이 생성되어야 한다.
- **FR-008**: 채팅방 UI는 상단바(뒤로가기, 전문가 이름, 분야), 대화 영역(말풍선), 면책 문구, 하단 입력창으로 구성되어야 한다.
- **FR-009**: 사용자 메시지는 오른쪽, AI 메시지는 왼쪽 말풍선으로 표시되어야 한다.
- **FR-010**: 메시지 전송은 전송 버튼 클릭 또는 Enter 키로 가능해야 한다.
- **FR-011**: AI 응답은 실시간 스트리밍으로 한 글자씩 표시되어야 한다.
- **FR-012**: AI 응답 생성 중 타이핑 표시(...)가 나타나야 한다.
- **FR-013**: AI 전문가는 상황 파악 질문을 먼저 던지고, 단계적으로 조언해야 한다.
- **FR-014**: AI 전문가는 위험 주제 감지 시 전문가/기관 방문을 권유해야 한다.
- **FR-015**: 면책 문구는 채팅방 입력창 위와 온보딩 페이지 하단에 상시 표시되어야 한다.
- **FR-016**: 사용자는 "나의 상담 이력" 메뉴에서 과거 채팅방 목록을 조회할 수 있어야 한다.
- **FR-017**: 사용자는 기존 채팅방을 선택하여 이전 대화를 이어서 진행할 수 있어야 한다.
- **FR-018**: AI는 이전 대화 맥락을 기억하며 대화의 연속성을 유지해야 한다.
- **FR-019**: 사용자의 종료 신호 시 AI가 상담을 정리하고 요약 카드를 생성해야 한다.
- **FR-020**: 상담 요약 카드에는 주제, 핵심 조언, 다음 액션 아이템이 포함되어야 한다.
- **FR-021**: AI가 대화 내용을 기반으로 채팅방 제목을 자동 생성해야 한다.
- **FR-022**: 메인 화면은 상단 헤더, 왼쪽 사이드바, 오른쪽 콘텐츠 영역의 3영역 레이아웃이어야 한다.
- **FR-023**: 사이드바 메뉴는 시작하기, 나의 상담 이력, 도움말, 계정 정보로 구성되어야 한다.
- **FR-024**: 사용자는 계정 정보 페이지에서 닉네임을 조회·수정할 수 있어야 한다.
- **FR-025**: 빈 메시지는 전송할 수 없어야 하며, 전송 버튼이 비활성화되어야 한다.
- **FR-026**: 메시지 입력에는 적절한 글자 수 제한이 있어야 한다.

### Key Entities

- **사용자 (User)**: 서비스를 이용하는 개인. 구글 계정으로 식별되며, 닉네임·이메일·프로필 이미지를 갖는다.
- **전문가 (Expert)**: AI가 구현하는 상담 전문가 캐릭터. 4개 분야(취업/연애/사주/육아) 중 하나에 속하며, 고유한 이름·설명·아이콘·행동 규칙을 갖는다.
- **채팅방 (Chat Room)**: 사용자와 전문가 간의 1:1 상담 공간. 제목, 상태(진행중/완료), 요약 정보를 갖는다. 하나의 사용자가 여러 채팅방을 가질 수 있다.
- **메시지 (Message)**: 채팅방 내의 개별 발화. 발신자 유형(사용자/AI), 내용, 전송 시간을 갖는다.

## Success Criteria *(mandatory)*

### Measurable Outcomes

- **SC-001**: 사용자가 처음 접속해서 로그인 완료까지 30초 이내에 도달할 수 있어야 한다.
- **SC-002**: 전문가 선택 후 채팅방이 열리고 첫 인사말이 표시되기까지 5초 이내에 완료되어야 한다.
- **SC-003**: 사용자가 메시지를 전송하면 AI 응답의 첫 글자가 3초 이내에 나타나야 한다.
- **SC-004**: 상담 이력 페이지에서 과거 채팅방 목록이 2초 이내에 로드되어야 한다.
- **SC-005**: 4개 전문가 분야 각각에서 사용자가 한 번의 상담을 완료(종료 신호까지)할 수 있어야 한다.
- **SC-006**: 상담 요약 카드 생성 시 주제·핵심 조언·액션 아이템 3가지 항목이 모두 포함되어야 한다.
- **SC-007**: 재방문 사용자의 90% 이상이 자동 로그인으로 메인 화면에 바로 진입해야 한다.
- **SC-008**: 기존 채팅방 재진입 시 이전 대화 내역이 100% 보존되어 표시되어야 한다.

## Assumptions

- 서비스 대상 사용자는 구글 계정을 보유한 한국어 사용자이다.
- AI 전문가는 한국어로만 대화한다.
- 면책 문구의 내용은 "AI가 제공하는 상담은 참고 목적이며, 전문적인 의료·법률·심리 상담을 대체할 수 없습니다."와 같은 일반적인 AI 면책 안내이다.
- 온보딩 페이지의 서비스 소개 문구와 디자인은 개발 단계에서 구체화한다.
- 도움말 페이지의 세부 콘텐츠는 서비스 주요 기능 완성 후 작성한다.
- 메시지 글자 수 제한은 일반적인 채팅 서비스 기준(2000자 이내)으로 설정한다.
- 구독 유형(free/premium)은 현재 스코프에서 free만 지원하며, premium 기능은 추후 확장한다.
- 데이터 보존은 서비스 운영 기간 동안 유지하며, 사용자 탈퇴 시 관련 데이터를 삭제한다.
